#!/bin/bash

# ========================================
# MANUAL TESTING GUIDE - PHASE 1 USE CASES
# ========================================

echo "========================================"
echo "DAILY WORKER HUB - TESTING GUIDE PHASE 1"
echo "========================================"
echo ""

echo "âœ… Use Cases Created for Phase 1:"
echo "========================================"
echo ""
echo "1. CreateJobUseCase"
echo "   - File: domain/usecase/CreateJobUseCase.kt"
echo "   - Validates: wage, worker count, dates, wage type"
echo "   - Tests: valid creation, invalid wage, invalid count, past date"
echo ""
echo "2. ApplyForJobUseCase"
echo "   - File: domain/usecase/ApplyForJobUseCase.kt"
echo "   - Validates: job status, duplicate application, 21 Days Rule"
echo "   - Tests: apply to open, apply to filled, duplicate check, 21 days violation"
echo ""
echo "3. CompleteJobUseCase"
echo "   - File: domain/usecase/CompleteJobUseCase.kt"
echo "   - Validates: job status, job started, hours worked"
echo "   - Tests: complete accepted job, complete without start, invalid hours"
echo ""
echo "4. GetJobDetailsUseCase"
echo "   - File: domain/usecase/GetJobDetailsUseCase.kt"
echo "   - Fetches: job + business + application status"
echo "   - Tests: get by ID, not found, with application"
echo ""

echo "========================================"
echo "DOMAIN MODELS CREATED"
echo "========================================"
echo ""
echo "1. JobRequestModels.kt"
echo "   - CreateJobRequest: create job request with validation"
echo "   - ApplyForJobRequest: apply for job request"
echo "   - CompleteJobRequest: complete job request"
echo ""
echo "2. JobWithDetails.kt"
echo "   - JobWithDetails: job with business info and application status"
echo "   - Helper methods: isJobAvailable, isAcceptingApplications"
echo ""

echo "========================================"
echo "REPOSITORY IMPLEMENTATION CREATED"
echo "========================================"
echo ""
echo "SupabaseJobRepository.kt"
echo "   - Implements JobRepository interface"
echo "   - Methods:"
echo "     âœ“ getWorkerProfile()"
echo "     âœ“ getWorkerHistory()"
echo "     âœ“ getWorkerStats()"
echo "     âœ“ getAvailableJobs()"
echo "     âœ“ acceptJob(jobId)"
echo "     âœ“ getJobById(jobId)"
echo "     âœ“ deleteJob(jobId)"
echo "     âœ“ createJob(request)"
echo "     âœ“ applyForJob(request)"
echo "     âœ“ getApplicationById(applicationId)"
echo "     âœ“ completeJob(appId, completedAt, hours, amounts)"
echo "     âœ“ getJobDetails(jobId)"
echo ""
echo "   - Features:"
echo "     â€¢ Supabase REST API integration"
echo "     â€¢ Full CRUD operations for jobs and applications"
echo "     â€¢ 21 Days Rule compliance checking"
echo "     â€¢ Worker statistics calculation"
echo "     â€¢ Error handling with logging"
echo ""

echo "========================================"
echo "DATABASE STATUS"
echo "========================================"
echo ""
echo "âœ… Dummy Data Already Inserted:"
echo "  â€¢ 13 auth users (10 workers + 3 businesses)"
echo "  â€¢ 16 profiles (10 workers + 3 businesses + 3 existing)"
echo "  â€¢ 12 worker_profiles with location and skills"
echo "  â€¢ 4 business_profiles with preferences"
echo "  â€¢ 25 jobs with various statuses (open, filled, closed)"
echo "  â€¢ 10 job_applications (pending, accepted, completed)"
echo "  â€¢ 13 wallets with balances"
echo ""

echo "========================================"
echo "TESTING INSTRUCTIONS"
echo "========================================"
echo ""
echo "ðŸ“± Android App Testing:"
echo "========================================"
echo ""
echo "1. Build and Run App"
echo "   ./gradlew assembleDebug"
echo "   adb install app/build/outputs/apk/debug/app-debug.apk"
echo ""
echo "2. Test Worker Flow:"
echo "   - Login as worker (test: +628551234567)"
echo "   - Browse jobs (GetJobsForWorkerUseCase)"
echo "   - Apply for job (ApplyForJobUseCase)"
echo "   - Accept application (AcceptJobUseCase - if business)"
echo "   - Complete job (CompleteJobUseCase)"
echo "   - Check stats (GetWorkerStatsUseCase)"
echo ""
echo "3. Test Business Flow:"
echo "   - Login as business (test: warungbali@example.com)"
echo "   - Create job (CreateJobUseCase)"
echo "     â€¢ Wage: 150000, worker_count: 2, date: tomorrow"
echo "     â€¢ Test validation errors:"
echo "       â€¢ Wage: 0 or negative"
echo "       â€¢ Worker count: 11 (>10) or 0"
echo "       â€¢ End time before start time"
echo "       â€¢ Shift date in past"
echo "   - Get applications (GetApplicationsForJobUseCase)"
echo "   - Accept application (AcceptJobUseCase)"
echo "   - View job details (GetJobDetailsUseCase)"
echo ""
echo "4. Test Edge Cases:"
echo "   â€¢ Worker apply for same job twice (duplicate)"
echo "   â€¢ Worker apply when 21 Days Rule violated (>20 days)"
echo "   â€¢ Business cancel job when already filled"
echo "   â€¢ Worker complete job before start"
echo "   â€¢ Invalid job ID in get details"
echo ""

echo "========================================"
echo "USE CASE VALIDATION MATRIX"
echo "========================================"
echo ""
echo "CreateJobUseCase:"
echo "â”œâ”€ Valid Input     â†’ Success (201 Created)"
echo "â”œâ”€ Wage <= 0      â†’ Failure (Validation Error)"
echo "â”œâ”€ Worker < 1      â†’ Failure (Validation Error)"
echo "â”œâ”€ Worker > 10     â†’ Failure (Validation Error)"
echo "â”œâ”€ End â‰¤ Start    â†’ Failure (Validation Error)"
echo "â””â”€ Past Date       â†’ Failure (Validation Error)"
echo ""
echo "ApplyForJobUseCase:"
echo "â”œâ”€ Open job       â†’ Success (Pending status)"
echo "â”œâ”€ Filled job     â†’ Failure (Not available)"
echo "â”œâ”€ Duplicate       â†’ Failure (Already applied)"
echo "â””â”€ > 20 days      â†’ Failure (21 Days Rule violation)"
echo ""
echo "CompleteJobUseCase:"
echo "â”œâ”€ Accepted job   â†’ Success (Completed status)"
echo "â”œâ”€ Not started    â†’ Failure (Job not started)"
echo "â”œâ”€ Hours â‰¤ 0      â†’ Failure (Invalid hours)"
echo "â””â”€ Net < 0        â†’ Failure (Invalid payment)"
echo ""

echo "========================================"
echo "NEXT STEPS"
echo "========================================"
echo ""
echo "Phase 2 Use Cases (Priority: High):"
echo "  1. RegisterWorkerUseCase"
echo "  2. RegisterBusinessUseCase"
echo "  3. GetWalletBalanceUseCase"
echo "  4. RequestWithdrawalUseCase"
echo "  5. CheckCompliance21DaysUseCase"
echo "  6. GetApplicationsForJobUseCase"
echo ""
echo "Integration Testing:"
echo "  1. Test complete flow: Worker Register â†’ Browse Jobs â†’ Apply â†’ Accept â†’ Complete"
echo "  2. Test complete flow: Business Register â†’ Create Job â†’ Get Applications â†’ Accept â†’ Complete"
echo "  3. Verify 21 Days Rule blocking works correctly"
echo "  4. Verify payment calculation (6% commission deducted correctly)"
echo ""
echo "========================================"
echo "ðŸ“Š Summary"
echo "========================================"
echo ""
echo "âœ… Phase 1 Complete!"
echo "   â€¢ 4 Use Cases implemented"
echo "   â€¢ 4 Domain Models created"
echo "   â€¢ 1 Repository implementation created"
echo "   â€¢ 25 jobs + 10 applications in database"
echo "   â€¢ Ready for Android app testing"
echo ""
echo "Total files created: 8"
echo "- domain/usecase/CreateJobUseCase.kt"
echo "- domain/usecase/ApplyForJobUseCase.kt"
echo "- domain/usecase/CompleteJobUseCase.kt"
echo "- domain/usecase/GetJobDetailsUseCase.kt"
echo "- domain/model/JobRequestModels.kt"
echo "- domain/model/JobWithDetails.kt"
echo "- data/repository/SupabaseJobRepository.kt"
echo "- scripts/test-phase-1.sh"
echo ""
echo "========================================"
